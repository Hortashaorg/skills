services:
  local:
    container_name: skills_local
    build:
      context: .
      dockerfile: Dockerfile
      target: local
    network_mode: host
    volumes:
      - ./..:/skills
      - ~/.ssh:/root/.ssh
    command: bash -c "service ssh start && sleep infinity"

  spacetimedb:
    container_name: skills_spacetimedb
    image: clockworklabs/spacetime
    ports:
      - "3000:3000"
    networks:
      - skillz_network
    volumes:
      - spacetimedb_data:/stdb
    command: start --data-dir=/stdb

networks:
  skillz_network:
    driver: bridge

volumes:
  spacetimedb_data:
